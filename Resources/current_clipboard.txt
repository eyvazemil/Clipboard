
void read_clip_history(Item ** items_start, Item ** items_end, char * file_name, int * current_queue_size, int size_of_clipboard) {
    int line_count = 0, str_len = 0, new_queue_size = 0;
    char * str = NULL, * line = NULL;
    FILE * fp = fopen(file_name, "r");
    Item * new_items_start = NULL, * new_items_end = NULL;
    size_t line_len = 0;

    /* read new clipboard */
    while((line_count = getline(&line, &line_len, fp))) {
        if(line_count < 0 || (isdigit(line[0]) && isdigit(line[1]) && line[2] == ':')) { // EOF or new record
            // insert into linked list
            if(str) {
                str[strlen(str) - 1] = '\0'; // last character in each record is added newline, so delete it
                insert_item(&new_items_start, &new_items_end, str, &new_queue_size, size_of_clipboard, 1);
            }
            // reset the string
            str_len = 0;
            free(str);
            str = NULL;
            // if EOF was reached
            if(line_count < 0) {
                free(line);
                break;
            }
        } else str_append(&str, line, &str_len);
        free(line);
        line_len = 0;
        line = NULL;
    }
    fclose(fp);
    // attach newly added items to the start of the queue(if they exist)
    free_only_queue(*items_start);
    *items_start = new_items_start;
    *items_end = new_items_end;
    *current_queue_size = new_queue_size;
}